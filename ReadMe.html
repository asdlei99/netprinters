<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
<title>NetPrinters ReadMe</title>
<meta name="GENERATOR" content="Quanta Plus">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<style type="text/css">
body {
	padding: 0px;
	margin: 5px;
	
	background-color: white;
	color: black;
	font-size: medium;
	font-family: sans-serif;
}

h1, h2 {
	margin: 5px 0px;
	padding: 0px;
}

h1 { font-size: x-large; }
h2 { font-size: large; }

a {
	color: blue;
	text-decoration: underline;
}

a:hover {
	color: red;
}

li {
	margin-bottom: 5px;
}

#contents li {
	margin: 0px;
}
</style>
</head>

<p>
<h1>NetPrinters ReadMe</h1>
<p>
Version 2.1<br>
Website: <a href="http://www.solemnwarning.net/netprinters/" target="_blank">
http://www.solemnwarning.net/netprinters/</a><br>
Copyright &copy; 2008 Daniel Collins
</p>
<p>
NetPrinters is a utility for managing the networked printer connections stored
in a user's profile on Windows workstations running Windows 2000 or newer. It
can be passed printers via the command line, or in a NetPrinters script which
allows setting up printers based on filters such as username and NetBIOS name.
</p>
<hr>
<h1>Contents</h1>
<ul id="contents">
<li><a href="#usage">Usage</a></li>
<li><a href="#expr">Expressions</a></li>
<li><a href="#script_0">Scripts</a>
<ul>
<li><a href="#script_1">Script format</a></li>
<li><a href="#script_2">Command directives</a></li>
<li><a href="#script_3">Filter directives</a></li>
</ul>
</li>
</ul>
<hr>

<h1 id="usage">Usage</h1>
<p>
The netprinters.exe program accepts the following arguments:
</p>
<ul>
<li>-c <i>\\SERVER\PrinterName</i><br>
Add printer connection to specified SMB printer.
</li>
<li>-d <i>\\SERVER\PrinterName</i><br>
Set default printer to specified SMB printer.
</li>
<li>-r <i>expression</i><br>
Delete any printer connections with UNC paths matching the supplied expression.
</li>
<li>-l<br>
List connected printers.
</li>
<li>-s <i>filename</i><br>
Execute a NetPrinters script.
</li>
</ul>
<hr>

<h1 id="expr">Expressions</h1>
<p>
NetPrinters has a simple expression language which can be used when comparing
strings, in its most basic usage it's just a case-insensitive string comparison
function, but it also has support for several wildcard characters:
</p>
<ul>
<li>* - Zero or more of any character</li>
<li>? - Any single character</li>
<li># - Any single integer</li>
</ul>
<hr>

<h1 id="script_0">Scripts</h1>
<h2 id="script_1">Script format</h2>
<p>
NetPrinters scripts are made from "blocks" of code, blocks of code contain
control and filter directives, the control directives of a block are executed
in order until a filter statement that evaluates false is encountered, then the
rest of the block is skipped. Blocks of code are seperated by one or more blank
lines, lines beginning with a # symbol are ignored as comments, but they will
not act as block seperators.
</p>
<p>
Scripts may have UNIX, Windows or even Macintosh line endings as newline and
return-carridge characters are stripped from the beginning and end of every
line. Whitespace is also stripped from the beginning of the line and after the
directive name, so you can have any number of spaces or tabs at the start of a
line, or between the directive name and its argument(s).
</p>

<h2 id="script_2">Command directives</h2>
<ul>
<li>AddPrinter <i>\\SERVER\PrinterName</i><br>
Add printer connection to an SMB printer.
</li>
<li>DefaultPrinter <i>\\SERVER\PrinterName</i><br>
Set default printer to specified SMB printer.
</li>
<li>DeletePrinter <i>expression</i><br>
Delete any printer connections with UNC paths matching the supplied expression.
</li>
<li>Exit<br>
Print a message to stdout and exit with status zero.
</li>
</ul>

<h2 id="script_3">Filter directives</h2>
<ul>
<li>NetBIOS <i>expression</i><br>
Evaluates true if the system NetBIOS name matches the supplied expression.
</li>
<li>!NetBIOS <i>expression</i><br>
Evaluates true is the system NetBIOS name does NOT match the supplied expression.
</li>
<li>Username <i>expression</i><br>
Evaluates true if the current username matches the supplied expression.
</li>
<li>!Username <i>expression</i><br>
Evaluates true if the current username does NOT match the supplied expression.
</li>
</ul>
</body>
</html>
