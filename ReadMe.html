<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
<title>NetPrinters documentation</title>
<meta name="GENERATOR" content="Quanta Plus">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<style type="text/css">
body {
	padding: 0px;
	margin: 5px;
	
	background-color: white;
	color: black;
	font-size: medium;
	font-family: sans-serif;
}

h1, h2 {
	margin: 5px 0px;
	padding: 0px;
}

h1 { font-size: x-large; }
h2 { font-size: large; }

a {
	color: blue;
	text-decoration: underline;
}

a:hover {
	color: red;
}
</style>
</head>

<p>
<h1>NetPrinters ReadMe</h1>
<p>
Version 2.1<br>
Website: <a href="http://www.solemnwarning.net/netprinters/" target="_blank">
http://www.solemnwarning.net/netprinters/</a><br>
Copyright &copy; 2008 Daniel Collins
</p>
<p>
NetPrinters is a utility for managing networked printer connections on Windows
workstations running Windows 2000 or newer. It can be passed printers via the
command line, or in a NetPrinters script which allows setting up printers based
on filters such as username and hostname.
</p>
<hr>
<h1>Contents</h1>
<ul>
<li><a href="#usage">Usage</a></li>
<li><a href="#expr">Expressions</a></li>
<li><a href="#script_0">Scripts</a>
<ul>
<li><a href="#script_1">Script format</a></li>
<li><a href="#script_2">Command directives</a></li>
<li><a href="#script_3">Filter directives</a></li>
</ul>
</li>
</ul>
<hr>

<h1 id="usage">Usage</h1>
<ul>
<li>-a<br>
Print "about" message.
</li>
<li>-e<br>
Print environment information (username, hostname, etc)
</li>
<li>-c <i>\\SERVER\PrinterName</i><br>
Add printer connection to specified SMB printer.
</li>
<li>-d <i>\\SERVER\PrinterName</i><br>
Set default printer to specified SMB printer.
</li>
<li>-r <i>Expression</i><br>
Remove all printer connections matching the supplied expression.
</li>
<li>-l<br>
List connected printers.
</li>
<li>-s <i>Filename</i><br>
Execute a NetPrinters script.
</li>
</ul>
<hr>

<h1 id="expr">Expressions</h1>
<p>
NetPrinters has a simple expression language which can be used when comparing
strings, in its most basic usage it's just a case-insensitive string comparison
function, but it also has support for several wildcard characters:
</p>
<ul>
<li>* - Zero or more of any character</li>
<li>? - Any single character</li>
<li># - Any single integer</li>
</ul>
<hr>

<h1 id="script_0">Scripts</h1>
<h2 id="script_1">Script format</h2>
<p>
NetPrinters scripts are made from "blocks" of code, blocks of code contain
control and filter directives, the control directives of a block are executed
in order until a filter statement that evaluates false is encountered, then the
rest of the block is skipped.
</p>
<p>
Blocks of code are seperated by one or more blank lines, lines beginning with a
hash (#) symbol are ignored as comments, but they will not act as block
seperators.
</p>

<h2 id="script_2">Command directives</h2>
<ul>
<li>AddPrinter <i>\\SERVER\PrinterName</i><br>
Add printer connection to an SMB printer.
</li>
<li>DefaultPrinter <i>\\SERVER\PrinterName</i><br>
Set default printer to specified SMB printer.
</li>
<li>DeletePrinter <i>\\SERVER\PrinterName</i><br>
Delete any printer connections matching the supplied expression, the printer
expression may make use of the * and ? wildcards to represent zero or more of
any character, or any one character respectively.
</li>
</ul>

<h2 id="script_3">Filter directives</h2>
<ul>
<li>NetBIOS <i>NetBIOS name</i><br>
Evaluates true if the system NetBIOS name matches the supplied NetBIOS name,
the supplied name may use the * and ? wildcards, which have the same effect as
documented in DeletePrinter.
</li>
<li>!NetBIOS <i>NetBIOS name</i><br>
Evaluates true is the system NetBIOS name does NOT match the supplied NetBIOS
name, basically the opposite of the NetBIOS directive. May also use the * and ?
wildcards like NetBIOS can.
</li>
<li>Username <i>Username expression</i><br>
Evaluates true if the current username matches the supplied username expression,
the supplied username expression may use the * and ? wildcards.
</li>
<li>!Username <i>Username expression</i><br>
Evaluates true if the current username does NOT match the supplied username
expression, the supplied username expression may use the * and ? wildcards.
</li>
</ul>
</body>
</html>
